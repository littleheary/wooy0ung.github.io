---
layout:    post
title:     CVE-2016-1749 macOS Kernel Information Leak
author:    wooy0ung
tags:      macos
category:  exploit
---


>[Analysis Environment]  
>virtual machine: OS X 10.11.3 EI Capitan
>affected system: OS X before 10.11.3(proved on 10.11~10.11.3)  
<!-- more -->


## 0x001

Let's check if_clone_list method in the "if.c" file
```
/*
 * Provide list of interface cloners to userspace.
 */
static int
if_clone_list(int count, int *ret_total, user_addr_t dst)
{
  char outbuf[IFNAMSIZ];
  struct if_clone *ifc;
  int error = 0;

  *ret_total = if_cloners_count;
  if (dst == USER_ADDR_NULL) {
    /* Just asking how many there are. */
    return (0);
  }

  if (count < 0)
    return (EINVAL);

  count = (if_cloners_count < count) ? if_cloners_count : count;

  for (ifc = LIST_FIRST(&if_cloners); ifc != NULL && count != 0;
       ifc = LIST_NEXT(ifc, ifc_list), count--, dst += IFNAMSIZ) {
    strlcpy(outbuf, ifc->ifc_name, IFNAMSIZ);
    error = copyout(outbuf, dst, IFNAMSIZ);
    if (error)
      break;
  }

  return (error);
}
```